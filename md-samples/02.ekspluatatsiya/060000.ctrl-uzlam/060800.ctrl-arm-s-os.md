# Управление АРМ с ОС Windows

В Комплексе для управления АРМ с ОС Windows используются классы и факты Puppet.

Для обеспечения такого управления на АРМ с ОС Windows должен быть установлен и настроен puppet-agent.

С помощью Комплекса можно выполнить операции, описанные в п. Управление АРМ с ОС Windows.

Следует обратить внимание, что операции будет выполняться каждый раз при отработке puppet-agent на АРМ. Для отключения операции нужно отвязать АРМ от группы узлов.

## Копирование файлов

Для копирования файлов из одной папки в другую как по сети, так и в файловой системе ПК нужно создать группу узлов и привязать к ней класс `rcc_win:copy_file`.

Для этого нужно выполнить следующие действия:

1. создать группу узлов (описано в п. Создание группы узлов);
2. перейти на вкладку "Puppet ENC" созданной группы и в доступных классах выбрать `rcc_win:copy_file`, который должен появиться в секции "Включенные классы" (рисунок 48);

::sign-image
---
src: /image58.png
sign: Рисунок 48 — Выбор класса
---
::

3. в параметрах выбранного класса задать значения (рисунок 49):
  - `rcc_win_copy_from` – директория, из которой нужно выполнить копирование;
  - `rcc_win_copy_to` – директория, в которую нужно выполнить копирование;

::sign-image
---
src: /image59.png
sign: Рисунок 49 — Параметры копирования
---
::

4. нажать кнопку `Применить`, класс будет привязан к группе;
5. добавить в эту группу те АРМ, для которых операция копирования актуальна, и при следующей отработке puppet-agent такая операция будет выполнена.

## Запуск исполняемого файла.

Для запуска какого-либо исполняемого файла необходимо выполнить следующие действия:

1. создать группу узлов (описано в п. Создание группы узлов);
2. перейти в пункт меню "Настройка → Группы узлов" и на вкладке "Классификатор узлов Puppet" в созданную группу добавить класс rcc_win:exec;
3. задать значение параметра rcc_win_exec_command – полный путь до исполняемого файла (рисунок 50);

::sign-image
---
src: /image60.png
sign: Рисунок 50 — Параметр rcc_win_exec_command
---
::

3. нажать кнопку `Применить`, класс будет привязан к группе;
4. добавить в эту группу те АРМ, для которых операция запуска актуальна, и при следующей отработке puppet-agent такая операция будет выполнена.

## Подключение сетевого диска

Для подключения сетевого диска к АРМ необходимо выполнить следующие действия:

1. создать группу узлов (описано в п. Создание группы узлов);
2. перейти в пункт меню "Настройка → Группы узлов" и на вкладке "Puppet ENC" в созданную группу добавить класс rcc_win:net_use (рисунок 51);

::sign-image
---
src: /image61.png
sign: Рисунок 51 — Выбор класса
---
::

3. в параметрах выбранного класса задать значения (рисунок 52):
  - rcc_win_net_disk_letter – имя подключаемого сетевого диска;
  - rcc_win_net_disk_passwd – пароль локального администратора;
  - rcc_win_net_disk_user – логин локального администратора;
  - rcc_win_net_path – полный путь подключаемой сетевой директории;

::sign-image
---
src: /image62.png
sign: Рисунок 52 — Параметры класса
---
::

4. нажать кнопку `Применить`, класс будет привязан к группе;
5. добавить в эту группу те АРМ, для которых операция подключения сетевого диска актуальна, и при следующей отработке puppet-agent такая операция будет выполнена.

**Следует обратить внимание**, что операция подключения сетевого диска будет выполнена под УЗ локального администратора, и подключенный диск не будет виден пользователям. Это действие используется только для обслуживания АРМ, например, для подключения диска администратором, а затем копирования файлов или папки на АРМ, чтобы в дальнейшем установить программу.

## Обзор установленного ПО

В Комплексе можно посмотреть установленное на АРМ программное обеспечение.

Для этого нужно открыть пункт меню "Наблюдение → Факты", найти и выбрать факт rcc_win_software, после чего отобразится список узлов с установленным на них ПО (рисунок 53).

::sign-image
---
src: /image63.png
sign: Рисунок 53 — Значение факта rcc_win_software
---
::

Например, чтобы посмотреть узлы, на которых установлена программа WinRAR, в строке поиска нужно ввести `! ~ WinRar` и получить отфильтрованный список узлов (рисунок 54).

::sign-image
---
src: /image64.png
sign: Рисунок 54 — Список узлов с установленным WinRAR
---
::

## Обзор установленных обновлений Windows

Для того чтобы посмотреть установленные на АРМ обновления Windows, нужно зайти в пункт меню "Наблюдение → Факты", найти и выбрать факт rcc_win_update, после чего отобразится список АРМ с установленными на них обновлениями ОС Windows (рисунок 55).

::sign-image
---
src: /image65.png
sign: Рисунок 55 — Список узлов с установленными обновлениями ОС Windows
---
::